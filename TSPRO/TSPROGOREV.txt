--6. soru ve 11.soru yapýlmadý--
--7.SORU--
 
 CREATE INDEX TAR_FATURA ON FATURA
        (
        FATURA_TARIHI ASC
        )

SELECT F.FATURA_REFNO,C.UNVANI,F.FATURA_TIPI,F.FATURA_TARIHI,F.ADRES,F.IL,F.ILCE FROM FATURA F JOIN CARI C ON F.CARI_REFNO=C.CARI_REFNO


--8.SORU--
SELECT SUM(URUN.SATIS_FIYATI)-SUM(URUN.ALIS_FIYATI) AS ALISSATIS, FATURA.FATURA_TARIHI FROM URUN 
JOIN FAT_DETAY ON URUN.URUN_REFNO=FAT_DETAY.URUN_REFNO 
JOIN FATURA ON FAT_DETAY.FATURA_REFNO=FATURA.FATURA_REFNO
GROUP BY FATURA.FATURA_TARIHI

--9.SORU--
--FOREIGN KEY YAPILDI

--10.SORU--

 CREATE INDEX DETAY_FAT ON FAT_DETAY
        (
        FATURA_REFNO ASC
        )

--11.SORU--YAPILMADI!!!!!!!!!!!!!!!!!!
INSERT INTO CARI_HAR(CARI_REFNO,TARIH,BORC,ALACAK) VALUES(2,GETDATE(),25,0)
INSERT INTO FATURA (CARI_REFNO,FATURA_TIPI,FATURA_TARIHI,ADRES,IL,ILCE,ILGILI_KISI,ACIKLAMA) VALUES (2,1,GETDATE(),'EGE MAH.','ANKARA','MAMAK','ÝREM H','DENEME')

--12.SORU--
FOREIGN KEY YAPILDI

--13.SORU--
  CREATE INDEX sýp_detay ON SIP_DETAY
         (
         SIP_DETAY_REFNO ASC
         )

--14.SORU--
SELECT FATURA.FATURA_TIPI,URUN.URUN_ADI,FAT_DETAY.MIKTAR FROM FATURA JOIN FAT_DETAY ON FATURA.FATURA_REFNO=FAT_DETAY.FATURA_REFNO
JOIN URUN ON FAT_DETAY.URUN_REFNO=URUN.URUN_REFNO
GROUP BY FATURA.FATURA_TIPI,FAT_DETAY.MIKTAR,URUN.URUN_ADI,FATURA.FATURA_TARIHI
HAVING FATURA_TIPI=1

--15.SORU--
CREATE VIEW VW_SIP_DETAY
AS
SELECT SD.SIPARIS_REFNO, U.URUN_ADI, SD.MIKTAR,SD.BIRIM_FIYATI,SD.BIRIMI,SD.KDV_ORANI,SD.KDV_TUTAR FROM SIP_DETAY SD
JOIN URUN U ON SD.URUN_REFNO=U.URUN_REFNO  

--16.SORU--
ALTER TABLE CARI
ADD CONSTRAINT UNVANI
UNIQUE (UNVANI)

--17.SORU--
CREATE VIEW VW_MUSTERI_HAREKET
AS
SELECT C.UNVANI,CH.TARIH,CH.BORC,CH.ALACAK FROM CARI_HAR CH
JOIN CARI C ON CH.CARI_REFNO=C.CARI_REFNO


--18.SORU--
ALTER TABLE URUN
ADD CONSTRAINT BARKODU 
UNIQUE (BARKODU)

ALTER TABLE URUN
ADD CONSTRAINT URUN_ADI 
UNIQUE (URUN_ADI)

--19.SORU--
 CREATE INDEX IURUN ON URUN_HAR
        (
        URUN_HAR_REFNO ASC
        )

--20.SORU--
SELECT U.URUN_ADI,UH.HAREKET_TARIH,UH.HAREKET_TIPI,U.ALIS_FIYATI,U.SATIS_FIYATI,UH.MIKTAR FROM URUN_HAR UH
JOIN URUN U ON UH.URUN_REFNO=U.URUN_REFNO


--21.SORU--
ALTER TABLE KULLANICI
ADD CONSTRAINT KULLANICI_ADI 
UNIQUE (KULLANICI_ADI)

--22.SORU--
ALTER TABLE KDV
ADD CONSTRAINT KDV_ORANI 
UNIQUE (KDV_ORANI)

--23.SORU--
ALTER TABLE KATEGORI
ADD CONSTRAINT KATEGORI_ADI 
UNIQUE (KATEGORI_ADI)

--24.SORU--
ALTER TABLE ALT_KATEGORI
ADD CONSTRAINT ALT_KATEGORI_ADI 
UNIQUE (ALT_KATEGORI_ADI)

--25.SORU--
CREATE VIEW VW_KATEGORI_ALT_KATEGORI 
AS 
SELECT KATEGORI.KATEGORI_ADI, ALT_KATEGORI.ALT_KATEGORI_ADI  FROM 
KATEGORI JOIN ALT_KATEGORI ON KATEGORI.KATEGORI_REFNO=ALT_KATEGORI.KATEGORI_REFNO

--26.SORU--
--FOREIGN KEY OLUÞTURULDU.


